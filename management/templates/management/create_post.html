{% extends 'portal/base.html' %}
{% block content %}
<div class="post-card" style="max-width: 600px; margin: auto;">
    <h2 style="text-align: center;">Nouvelle Publication</h2>
    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <label>Type de publication :</label>
        <select name="post_type" id="id_type" onchange="checkType()" style="width: 100%; padding: 10px; margin: 10px 0;">
            <option value="GENERAL">Générale (Social)</option>
            <option value="NEWS">Communiqué Officiel</option>
            <option value="SCHEDULE">Horaire de Cours</option>
        </select>

        <label>Titre :</label>
        <input type="text" name="title" required style="width: 100%; padding: 10px; margin: 10px 0;">

        <label>Contenu :</label>
        <textarea name="content" rows="4" style="width: 100%; padding: 10px; margin: 10px 0;"></textarea>

        <label>Promotion (Optionnel) :</label>
        <select name="promotion" style="width: 100%; padding: 10px; margin: 10px 0;">
            <option value="">---------</option>
            {% for promo in promotions %}
                <option value="{{ promo.id }}">{{ promo.name }} ({{ promo.department.name }})</option>
            {% endfor %}
        </select>
        <div id="media-fields">
            <label>Image :</label> <input type="file" name="image" accept="image/*"><br><br>
            <label>Vidéo :</label> <input type="file" name="video" accept="video/*">
        </div>

        <div id="pdf-field" style="display:none; background: #fff3f3; padding: 15px; border-radius: 5px; margin-top: 10px;">
            <label>Fichier PDF (Horaire) :</label>
            <input type="file" name="document_pdf" accept=".pdf">
        </div>

        <button type="submit" class="btn-primary" style="width: 100%; border: none; padding: 15px; margin-top: 20px; cursor: pointer;">PUBLIER</button>
    </form>
</div>

<script>
function checkType() {
    var type = document.getElementById('id_type').value;
    var pdfBox = document.getElementById('pdf-field');
    pdfBox.style.display = (type === 'SCHEDULE') ? 'block' : 'none';
}
</script>
{% endblock %}